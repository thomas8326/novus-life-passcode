<div class="w-full h-full flex flex-col items-center py-4">
  @switch (shoppingStatus()) {
    @case (Status.Cart) {
      <div class="w-full px-2 lg:w-[80%] lg:px-0 flex-1">
        <div
          class="grid-cols-[repeat(24,minmax(0,_1fr))] gap-2 mb-2.5 items-center bg-[#fafffe] p-4 rounded-md shadow hidden lg:grid"
        >
          <app-checkbox
            [checked]="
              cartItems.length > 0 &&
              selectedCartItem.length === cartItems.length
            "
            (checkedChange)="onSelectAllCartItem($event, cartItems)"
          ></app-checkbox>

          <div class="col-span-11 font-bold">全選商品</div>
          <div class="col-span-3 font-bold text-center"></div>
          <div class="col-span-3 font-bold text-center"></div>
          <div class="col-span-4 font-bold text-center"></div>
          <div class="col-span-2 font-bold text-center"></div>
        </div>
        @for (cart of cartItems; track cart.cartId) {
          @if (responsive.getDeviceObservable() | async; as device) {
            <div
              class="rounded-md shadow overflow-hidden mx-3 mb-2 lg:mb-4 lg:mx-0"
            >
              @if (device.desktop) {
                <app-desktop-cart-item
                  [cart]="cart"
                  [checked]="selectedCartItem.includes(cart)"
                  (select)="onSelectCartItem($event, cart)"
                  (remove)="onRemoveCartItem($event)"
                  (updateQuantity)="
                    updateQuantity($event.cartId, $event.quantity)
                  "
                ></app-desktop-cart-item>
              } @else {
                <app-mobile-cart-item
                  [cart]="cart"
                  [checked]="selectedCartItem.includes(cart)"
                  (select)="onSelectCartItem($event, cart)"
                  (remove)="onRemoveCartItem($event)"
                  (updateQuantity)="
                    updateQuantity($event.cartId, $event.quantity)
                  "
                ></app-mobile-cart-item>
              }
            </div>
          }
        }
      </div>
    }
    @case (Status.Checkout) {
      <div class="w-full px-2 lg:w-[80%] lg:px-0 flex-1">
        @if (myAccount$ | async; as myAccount) {
          <div
            class="rounded-md shadow overflow-hidden bg-white p-4 my-3 mx-3 mb-2 lg:mb-4 lg:mx-0"
          >
            <div class="flex gap-1">
              <div>轉帳銀行/帳號:</div>
              <div>{{ remittance?.bankCode }} - {{ remittance?.account }}</div>
            </div>
            <div class="flex gap-1">
              <div>收件人名稱:</div>
              <div>
                {{ myAccount.name }}
              </div>
            </div>
            <div class="flex gap-1">
              <div>收件人地址:</div>
              <div>{{ myAccount.zipCode }}</div>
              <div>{{ myAccount.address }}</div>
            </div>
          </div>
        }
        @for (cart of selectedCartItem; track cart.cartId) {
          @if (responsive.getDeviceObservable() | async; as device) {
            <div class="mx-3 mb-2 lg:mb-4 lg:mx-0">
              <app-expanded-cart-layout>
                <div
                  display
                  class="text-[#996251] px-4 py-3 flex items-center justify-between lg:text-desktopSubTitle"
                >
                  <div>{{ cart.crystal.name }}</div>
                  <div>
                    {{ cart.prices.discountPrice * cart.quantity | twCurrency }}
                  </div>
                </div>
                <div
                  content
                  class="rounded-br-md rounded-bl-md overflow-hidden"
                >
                  @if (device.desktop) {
                    <app-desktop-cart-item
                      [showCheckbox]="false"
                      [showTextQuantity]="true"
                      [cart]="cart"
                    ></app-desktop-cart-item>
                  } @else {
                    <app-mobile-cart-item
                      [showCheckbox]="false"
                      [showTextQuantity]="true"
                      [cart]="cart"
                    ></app-mobile-cart-item>
                  }
                </div>
              </app-expanded-cart-layout>
            </div>
          }
        }
      </div>
    }
  }
</div>

<footer
  class="fixed h-[100px] w-full bottom-0 left-0 right-0 px-10 bg-primary border-t border-highLight"
>
  <div class="flex items-center justify-between w-full h-full">
    <div>{{ getSelectedTotalPrices() | twCurrency }}</div>
    <button
      class="bg-highLight hover:bg-highLightHover border rounded-sm py-2 px-8 text-white"
      (click)="onBuy()"
    >
      {{ shoppingStatus() === Status.Cart ? "去買單" : "下訂單" }}
    </button>
  </div>
</footer>
